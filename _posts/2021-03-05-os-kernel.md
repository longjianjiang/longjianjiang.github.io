# 操作系统内核

## 什么是内核。

操作系统是管理硬件和软件的系统软件。内核则是操作系统的核心部分，内核负责管理进程，内存，各种硬件驱动程序，文件，网络等等。

内核可以分为宏内核，微内核，混合内核。

宏内核是内核中各个功能模块是集成在一起的，模块之间通过函数调用进行交互，性能较高。

微内核中只提供最核心的功能，比如任务调度，内存管理，其他的模块从内核中移除，安排到单独的用户态进程。这样稳定性，灵活性提高，因为某个模块出问题了，只需要重启该模块，不会影响到其他模块。
模块之间通信需要通过进程间通信，效率相对较低。

混合内核则综合宏内核和微内核的优点。内核中最核心的功能（任务调度，内存管理）依然放置在内核，而将微内核中的模块运行在内核态，增加了运行效率。

## XNU 内核

macOS的内核是一种混合内核，叫做XNU。XNU的核心是Mach，在Mach之上建立了BSD层，它们在同一个地址空间。

![xnu]({{site.url}}/assets/images/blog/os_kernel_1.jpeg)