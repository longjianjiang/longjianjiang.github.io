---
layout: post
title:  "SQL 笔记"
date:   2019-02-27
excerpt:  "本文是笔者记录的SQL操作的笔记"
tag:
- Database
comments: true
---

> 本文是笔者记录的SQL操作的笔记。

## constraint(表约束 & 列约束)

创建表时可以使用 `constraint` 来指定表约束，比如联合主键，也可以用来指定列约束，如下所示:

{% highlight sql %}
create table test_t (
    id_1 integer not null, -- column constraint
	id_2 integer,
    constraint id2_notnull_constraint unique(id_2), -- column constraint
    constraint multi_primary_constraint primary key(id_1 desc, id_2) -- table constraint
);
{% endhighlight %}

## on conflict clauses

创建表的时候，可以使用 `on conflict` 子句来指定当约束冲突的时候解决方案，如下所示:

> 适用于 `unique`, `not null`, `check`, `primary key` 约束。

{% highlight sql %}
create table tab_on_conflict_abort    (id int primary key unique on conflict abort   , txt text);
create table tab_on_conflict_fail     (id int primary key unique on conflict fail    , txt text);
create table tab_on_conflict_ignore   (id int primary key unique on conflict ignore  , txt text);
create table tab_on_conflict_replace  (id int primary key unique on conflict replace , txt text);
create table tab_on_conflict_rollback (id int primary key unique on conflict rollback, txt text);
{% endhighlight %}

可以看到有五种解决方案，默认是 `abort` 方案。

[ref1](https://sqlite.org/lang_conflict.html)

