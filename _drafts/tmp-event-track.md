
> 本文记录常见的埋点方案。

# 代码打点

这种方式一般是需要一些特定的业务参数，只能在具体的地方进行写打点代码；

# 可视化打点

代码打点的不足在于，首先是每次都要开发去添加，其次是更新需要跟随发版。所以为了解决打点的更新问题，可视化打点出现了。

可视化打点的思路就是将具体打哪些点作为配置进行下发给客户端，这样就可以动态更新打点。

具体的操作是，在管理后台找到某个需要打点的页面，选中某个按钮，此时进行标记点击按钮时进行上报，此时会生成一个配置进行下发给客户端，客户端在启动或者是定时请求最新的配置，拿到配置后，当点击被标记的按钮时，会进行一次事件的上报。

具体实现的原理是，当客户端和打点服务器连接时，服务端会发送一个绘制屏幕请求，这一步客户端会将当前屏幕截图，并且将屏幕上的控件按视图层级生成视图树发送给服务端。服务端拿到这些信息，可以展示在后台，此时可以进行事件的配置，配置好了以后进行下发，客户端拿到配置后，根据唯一的视图树的路径，通过`addTarget:action:forControlEvents:`方法添加事件，在事件处理函数中调用上报方法，这样就完成了打点的上报。

可视化打点的缺点在于，不能自定义上报的参数，一般只能带一些通用的参数。

# 无埋点

无埋点就是不需要事件配置，对页面中所有相关控件的事件统统上报，而具体分析的时候，可以进一步筛选。

# References

[ref1](https://neyoufan.github.io/2017/04/19/ios/%E7%BD%91%E6%98%93HubbleData%E6%97%A0%E5%9F%8B%E7%82%B9SDK%E5%9C%A8iOS%E7%AB%AF%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/)

[https://sensorsdata.cn/blog/shu-ju-jie-ru-yu-mai-dian/](https://sensorsdata.cn/blog/shu-ju-jie-ru-yu-mai-dian/)

[https://note.youdao.com/ynoteshare1/index.html?id=714a5106ce80e20f3d477f3046a057dd&type=note#/](https://note.youdao.com/ynoteshare1/index.html?id=714a5106ce80e20f3d477f3046a057dd&type=note#/)
